<!doctype html>
<html lang="en">
<head>
  <title>FrugalOS - An art and programming experiment</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.13.2/themes/smoothness/jquery-ui.css">
  <link type="text/css" rel="stylesheet" href="css/main.css">
  
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.2/jquery-ui.js"></script>
  <!--script src="script/exif-js.js"></script-->
  <!-- Note: I'd like to add EXIF data parsing eventually, but I'm struggling with it atm, so I'm shelving it for now.-->
  <script>
  // jQuery fuctions only here
  var dateOutput = "";
  var month = "";
  var day = "";
  
	  $( function() {
		// This gets the date and stores it in a variable. This will probably be used in several places.
		var d = new Date();

		month = d.getMonth()+1;
		day = d.getDate();

		dateOutput = (month<10 ? '0' : '') + month + '/' +
			(day<10 ? '0' : '') + day + "/" + d.getFullYear();

	  // This makes all the windows draggable
		$( ".draggable" ).draggable();
	  
	  // This is for closing windows
		$(".close").click(function() {
			$(this).parents(".window").hide();
		});
		
	  // This is for minimizing windows
	    $(".minimize").click(function() {
			// Get the window's title
			var windowTitle = $(this).parent().children(".windowTitle");
			// Get the window's ID
			var windowID = $(this).parents(".window").attr('id');
			
			// Add an li element in our taskbar with text and a link that matches the window's title
			$("#minimizedApps").append("<li><a href='#' onclick=showWindow('" + windowID + "') class='" + windowID + "'>" + windowTitle.text() + "</a></li>");
		
			// Hide the window as in the previous function
			$(this).parents(".window").hide();
		});
	  
	  // This is for toggling menus
		$(".toggleMenu").click(function() {
			$("#beginMenu").toggle();
		});
		
		// This is specifically for the Begin menu in the taskBar
		$("#beginMenu").menu();
		
		// This is for any element that has the .menu class
		$(".menu").menu();
		
		// This is for the settings pane
		$("#settings .bgPicker img").click(function() {
			var url = $(this).attr("src");
			$("body").css("background-image", "url(" + url + ")");
			return false;
		});

		// This is for starting one of the games (Cycloa emulator). This should probably be moved to some place more logical

		$("#cycloaLink").click(function(){
	  	$.ajax({
		    url: "files/CycloaJS-magistra/index.html",

		    dataType: "jsonp",
		 
		    // Work with the response
            success: function(dataWeGotViaJsonp){
                var text = dataWeGotViaJsonp;

                $('#progWindow').html(text);
		    }
		});
	  });
	  
	  // This is for photo viewing functions
	  $('#openFile').change(function(){
        const file = this.files[0];
		var imgData = "";
        if (file){
          let reader = new FileReader();
          reader.onload = function(event){
            $('#exifData p').append(event.target.result);
            $('#staticImage').attr('src', event.target.result);
			imgData = event.target.result;
          }
          reader.readAsDataURL(file);
        }
      });
	});
  </script>

<!--- Link scripts for specific apps here ---->
   <script src="script/downloadFile.js"></script>
   <script src="script/calc.js"></script>
   <script src="script/textpad.js"></script>
   <script src="script/paganTools.js"></script>
   <script src="script/csvEdit.js"></script>
</head>

<body>
    <div id="desktop">
	<!------  Desktop icons are here ------->
		<div id="desktopIcons">
			<div>
				<p><a href="#" onclick="showWindow('myComputer')"><img src="img/icon_mycomputer_2x.png" alt="My Computer"><br>
				<span class="iconLabel">Computer</span></a></p>
				
				<p><a href="#" onclick="showWindow('welcomeTXT')"><img src="img/icon_text_2x.png" alt="Welcome.txt"><br>
				<span class="iconLabel">Welcome.txt</a></span></p>
				
				<p><a href="#" onclick="showWindow('settings')"><img src="img/icon_settings_2x.png" alt="Settings"><br>
				<span class="iconLabel">Settings</span></a></p>
				
				<p><a href="#" onclick="showWindow('textpad')"><img src="img/icon_textpad_2x.png" alt="Textpad"><br>
				<span class="iconLabel">Textpad</span></a></p>

				<p><a href="#" onclick="showWindow('calculator')"><img src="img/icon_calculator_2x.png" alt="Calculator"><br>
				<span class="iconLabel">Calculator</span></a></p>

				<p><a href="#" onclick="showWindow('csvEdit')"><img src="img/icon_csv_2x.png" alt="csvEdit"><br>
				<span class="iconLabel">csvEdit</span></a></p>
				
				<p><a href="#" onclick="showWindow('gamesFolder')"><img src="img/icon_games_2x.png" alt="gamesFolder"><br>
				<span class="iconLabel">Games</span></a></p>
			</div>
			<div>
				<p><a href="#" onclick="showWindow('paganTools')"><img src="img/icon_pentacle_2x.png" alt="paganTools"><br>
				<span class="iconLabel">Pagan Tools</span></a></p>

				<p><a href="#" onclick="showWindow('ftharkReader')"><img src="img/icon_fthark_2x.png" alt="ftharkReader"><br>
				<span class="iconLabel">Fthark Reader</span></a></p>

				<p><a href="#" onclick="showWindow('imageViewer')"><img src="img/icon_imageViewer_2x.png" alt="imageViewer"><br>
				<span class="iconLabel">Image Viewer</span></a></p>
			</div>
		</div>
		
		<div class="window draggable off" id="imageViewer">
			<div class="menuBar">
				<span id="computerWindow" class="windowTitle">Image Viewer</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<!--canvas id="displayImage"></canvas><br-->
				<img src="" id="staticImage"><br>
				<input type="file" value="Open..." id="openFile">
				
				<details id="exifData">
					<summary>Base64</summary>
					<p><span id="makeAndModel"></span></p>
				</details>
			</div>

		</div>		
		
		<div class="window draggable off" id="settings">
			<div class="menuBar">
				<span id="computerWindow" class="windowTitle">Settings</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<div class="bgPicker">
					<h2>Backgrounds</h2>

					<p><a href=""><img src="img/background1.jpg"></a> <a href=""><img src="img/CrystallinePlain.png"></a> <a href=""><img src="img/CyrPoint.jpg"></a> <a href=""><img src="img/DarkSeas.png"></a> <a href=""><img src="img/Decadence.png"></a> <a href=""><img src="img/IridescentSapdrinker.png"></a> <a href=""><img src="img/lapse.png"></a> <a href=""><img src="img/TerrideCrisis.png"></a> <a href=""><img src="img/TheFallofGharat.png"></a> <a href=""><img src="img/HappyHalloween.png"></a></p>
				</div>
				To be added:
				<ul>
					<li>Font changes (size, color, family)</li>
					<li><strike>Desktop image</strike></li>
					<li>color schemes</li>
				</ul>
			</div>
		</div>
		
		<div class="window draggable off" id="textpad">
			<div class="menuBar">
				<span id="computerWindow" class="windowTitle">Textpad 0.1</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<div class="progMenu">
					<ul class="menu">
						<li><a href="#">File</a>
							<ul>
								<li><a href="#" id="textpad-save-menu">Save</a></li>
								<li><a href="#" id="textpad-open-menu">Open...</a></li>
							</ul>
						</li>
						<li><a href="#">Edit</a></li>
						<li><a href="#" id="textpad-about-menu">About</a></li>
					</ul>
				</div>
				<div class="uiButtons">
					<input type="button" value="H1" id="H1" class="markdown"> <input type="button" value="H2" id="H2" class="markdown"> <input type="button" value="H3" id="H3" class="markdown"> <input type="button" value="Bold" id="bold" class="markdown"> <input type="button" value="Italic" id="italic" class="markdown"> <input type="button" value="hr" id="hr" class="markdown">
				</div>
				<textarea id="textpad_wa"></textarea>
				<div class="uiButtons">
					<input type="button" value="Clear" id="textpad-clear"> <input type="button" value="Save" id="textpad-save"> <input type="file" value="Open..." id="textpad-open" onchange="loadTxtFile()" style="display: none;">
				</div>
			</div>
			
			<div class="off" id="aboutDialogue" title="About Textpad">
				<p>TextPad is a simple plain text and markdown editor that I've put together as a programming learning tool. You can currently use it to create, open, and edit plain text files.</p>
			</div>
			
			<div class="off" id="modalDialogue" title="Warning!">
				<p>Are you sure? Anything that has not been saved will be lost!</p>
				
				<p><input type="button" value="No" class="dialogueBtn"> <input type="button" value="Yes" id="textpad_ybtn" class="dialogueBtn"></p>
			</div>
		</div>
		
		<div class="window draggable off" id="myComputer">
			<div class="menuBar">
				<span id="computerWindow" class="windowTitle">Computer</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<div class="folderIcon">
					<a href=""><img src="img/icon_harddrive_2x.png" alt="Hard Drive"></a><br>
					<span class="iconLabel">OS Storage</span></a>
				</div>
				<div class="folderIcon">
					<a href=""><img src="img/icon_browserStorage_2x.png" alt="BrowserStorage"></a><br>
					<span class="iconLabel">Browser Storage</span></a>
				</div>				
			</div>
		</div>
		
		<div class="window draggable" id="welcomeTXT">
			<div class="menuBar">
				<span id="introWindow" class="windowTitle">Welcome.txt</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<h1>Welcome to FrugalOS</h1>

				<p>This document will change throughout time as I add more to it. <a href="#" title="This should popup on mouseover">This is a test tooltip.</a></p>

				<h2>Update Log</h2>

				<p>0.1 - Project begin</p>
				
				<h2>To Do List</h2>
				
				<ul>
					<li><strike>Make window code modular</strike></li>
					<li><strike>Implement close and minimize menu buttons</strike></li>
					<li><strike>Add desktop icons</strike></li>
					<li><strike>Add/Program calculator</strike></li>
					<li><strike>Add save/open function to TextPad</strike></li>
					<li><strike>Add basic markdown buttons to Textpad</strike> - Next step is to add an interpreter</li>
					<li><strike>Add backgrounds and switcher</strike></li>
					<li><strike>Add CSV editor</strike></li>
					<li><strike>Add image viewer</strike> - Would like to add more features eventually</li>
					<li>Fix CsvEdit importing function</li>
					<li>Get started on a pixel editor</li>
					<li>Get started on a solitaire/minesweeper game</li>
					<li>Add search function to TextPad and CSVEdit</li>
					<li><strike>Finish adding mem function to calculator</strike></li>
				</ul>	
			</div>
		</div>

		<div class="window draggable off" id="calculator">
			<div class="menuBar">
				<span id="calculator-span" class="windowTitle">Calculator</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<div class="progMenu">
					<ul class="menu">
						<li><a href="#">File</a>
						<ul>
							<li><a href="#" id="calc-show-mem">Memory</a></li>
						</ul></li>
					</ul>
				</div>
				
				<span id="calc_result">0</span><br>
				<table>
					<tr>
						<td><input type="button" value="1"></td>
						<td><input type="button" value="2"></td>
						<td><input type="button" value="3"></td>
						<td><input type="button" value="+"></td>
					</tr>
					<tr>
						<td><input type="button" value="4"></td>
						<td><input type="button" value="5"></td>
						<td><input type="button" value="6"></td>
						<td><input type="button" value="-"></td>
					</tr>
					<tr>
						<td><input type="button" value="7"></td>
						<td><input type="button" value="8"></td>
						<td><input type="button" value="9"></td>
						<td><input type="button" value="x"></td>
					</tr>
					<tr>
						<td><input type="button" value="0"></td>
						<td><input type="button" value="."></td>
						<td><input type="button" value="C"></td>
						<td><input type="submit" value="="></td>
					</tr>
				</table>
				
				<div id="calc-memory" class="off">
					<h2>Memory</h2>
					<a href="" class="clear-clear">(clear)</a><br>
					<span id="calc-mem-display"></span>
				</div>
			</div>
		</div>


		<div class="window draggable off" id="csvEdit">
			<div class="menuBar">
				<span id="csvEdit-span" class="windowTitle">csvEdit</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<div class="progMenu">
					<ul class="menu">
						<li><a href="#">File</a>
						<ul>
							<li><a href="#" class="new">New</a></li>
							<li><a href="#" class="save">Save</a></li>
							<li><a href="#" class="open">Open</a></li>
						</ul></li>
						<li><a href="#" class="help">Help</a></li>
					</ul>
				</div>
				
				<div class="off" id="csv-modalDialogue" title="Warning!">
					<p>Are you sure? Anything that has not been saved will be lost!</p>
					
					<p><input type="button" value="No" class="dialogueBtn"> <input type="button" value="Yes" id="csvEdit_ybtn" class="dialogueBtn"></p>
				</div>

				<div class="progMenu">
					<input type="button" value="insertRow" id="insert-row"> <input type="button" value="insertCell" id="insert-cell"> <input type="button" value="removeRow" id="remove-row"> <input type="button" value="removeCell" id="remove-cell">
				</div>
				
				<table class="csvDisplay">
					<tr>
						<td class="csv-td-r0c1"><input type="text" class="csv-text-r0c1"></td>
						<td class="csv-td-r0c2"><input type="text" class="csv-text-r0c2"></td>
						<td class="csv-td-r0c3"><input type="text" class="csv-text-r0c3"></td>
						<td class="csv-td-r0c4"><input type="text" class="csv-text-r0c4"></td>
					</tr>
					<tr class="even">
						<td class="csv-td-r1c1"><input type="text" class="csv-text-r1c1"></td>
						<td class="csv-td-r1c2"><input type="text" class="csv-text-r1c2"></td>
						<td class="csv-td-r1c3"><input type="text" class="csv-text-r1c3"></td>
						<td class="csv-td-r1c4"><input type="text" class="csv-text-r1c4"></td>
					</tr>
					<tr>
						<td class="csv-td-r2c1"><input type="text" class="csv-text-r2c1"></td>
						<td class="csv-td-r2c2"><input type="text" class="csv-text-r2c2"></td>
						<td class="csv-td-r2c3"><input type="text" class="csv-text-r2c3"></td>
						<td class="csv-td-r2c4"><input type="text" class="csv-text-r2c4"></td>
					</tr>
					<tr class="even">
						<td class="csv-td-r3c1"><input type="text" class="csv-text-r3c1"></td>
						<td class="csv-td-r3c2"><input type="text" class="csv-text-r3c2"></td>
						<td class="csv-td-r3c3"><input type="text" class="csv-text-r3c3"></td>
						<td class="csv-td-r3c4"><input type="text" class="csv-text-r3c4"></td>
					</tr>
				</table>
				
				<input type="file" value="Open..." id="csvEdit-open" onchange="loadCsvFile()" style="display: none;">
			</div>
		</div>
		
		<div class="window draggable off" id="gamesFolder">
			<div class="menuBar">
				<span id="csvEdit-span" class="windowTitle">Games</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<iframe src="games.html">This requires frames</iframe>
			</div>
		</div>

		<div class="window draggable off" id="paganTools">
			<div class="menuBar">
				<span id="csvEdit-span" class="windowTitle">Pagan Tools</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<h2>Wheel of the Year</h2>
				
				<div id="wheelOfTheYear">
					<img src="img/wheelOfTheYear.png" alt="Wheel of the Year illustration"><br>
					<span class="currentDate"></span><br>
					<b>Current lunar phase:</b> <span class="lunarPhase"></span><br>
					<b>Next full moon:</b> <span class="nextFull"></span><br>
					<b>Next Sabbat:</b> <span class="nextSabbat"></span><br>
				</div>
			
				<h2>Runes</h2>
				<div class="runes">
					<h3>Witches Runes</h3>
					<div id="witchesRunes">
						<span class="error" style="display: none;">ERROR: Please enter your intention</span><br>
						<input type="text" value="Enter intention" class="intention"><br><input type="button" value="Draw rune" onclick="pullWitchRune()"> <input type="button" value="clear" onclick="clearDiv('wruneResult')">
						<div id="wruneResult"></div>
						<p>You can pull as many runes as you like by clicking the button above. Hover over each rune to see its meaning</p>
					</div>

					<h3>City Runes</h3>
					<div id="cityRunes">
						<p>City Runes were created by Christopher Penczack in his book <i>City Magick,</i> and I think are a fun way to work modern world symbols into one's divination practice.</p>
						<span class="error" style="display: none;">ERROR: Please enter your intention</span><br>
						<input type="text" value="Enter intention" class="intention"><br><input type="button" value="Draw rune" onclick="pullCityRune()"> <input type="button" value="clear" onclick="clearDiv('cruneResult')">
						<div id="cruneResult"></div>
						<p>You can pull as many runes as you like by clicking the button above. Hover over each rune to see its meaning</p>
					</div>		
				</div>
				<h2>Tarot Reading tools</h2>
			</div>
		</div>

		<div class="window draggable off" id="ftharkReader">
			<div class="menuBar">
				<span id="csvEdit-span" class="windowTitle">Fthark Reader</span>
				<a href="#" class="minimize">_</a> | <a href="#" class="close">X</a>
			</div>
			
			<div class="content">
				<h3>Fthark</h3>
				<div id="ftharkRunes">
					<p>You can pull as many runes as you like by clicking the button below. Their meaning and other info will be displayed below.</p>
					<input type="button" value="Draw single rune" onclick="displayFtharkRune()"> <input type="button" value="clear" onclick="clearDiv('fruneResult')">
					<div id="fruneResult"></div>

					<div class="clear"><hr></div>

					<p>Here you can pull specific spreads</p>
					<select type="dropdown" value="Choose spread" id="spreadName">
						<option value="threerune">Three rune spread</option>
						<option value="fourdwarves">The four dwarves</option>
						<option value="crossofthor">The Cross of Thor</option>
						<option value="fiveelements">The five elements</option>
						<option value="fiveelements2">The five elements (alt)</option>
						<option value="fourdwarves2">The four dwarves (alt)</option>
						<option value="situation">Situation spread</option>
						<option value="persona">The persona</option>
						<option value="celticcross">Celtic cross</option>
						<option value="runiccross" disabled>Runic cross</option>
						<option value="career" disabled>Career mirror</option>
						<option value="sevenworlds" disabled>Seven worlds spread</option>
						<option value="combinedworlds" disabled>Combined worlds spread</option>
						<option value="mimirshead" disabled>Mimir's Head</option>
						<option value="mimirshead2" disabled>Mimir's Head (alt)</option>
						<option value="ninegrid" disabled>Grid of Nine</option>
						<option value="treeoflife" disabled>Tree of Life</option>
						<option value="cosmicaxis" disabled>Cosmic axis</option>
						<option value="fourquarters" disabled>The four quarters</option>
						<option value="celticknight" disabled>The Celtic Knight Cross</option>
						<option value="runicwheel" disabled>The runic wheel</option>
					</select>
					<input type="button" value="Draw spread" onclick="pullFtharkSpread()"> <input type="button" value="clear" onclick="clearDiv('ftharkSpreadResult')">

					<div id="ftharkSpreadResult"></div>
				</div>
			</div>
		</div>

	</div>
	
	
	<ul id="beginMenu" class="beginMenuLinks" style="display: none">
		<li><div><a href="#">Link1</a></div></li>
		<li><div><a href="#">Link2</a></div>
			<ul>
				<li><div>Sub link here</div></li>
			</ul>
		</li>
		<li><div><a href="#">Link3</a></div></li>
	</ul>
	
	<div id="taskBar">
		<a href="#" class="toggleMenu" id="toggleBegin">Begin</a>
		
		<ul	id="minimizedApps">
		</ul>
		
		<div id="rightTaskbar">
			<span id="time">00:00</span>
		</div>
	</div>
	
	<script>
		// javascript functions only here
		
		//This shows the window you pass to it. I've done this in javascript rather than jQuery because it's
		// easier in js to pass the ID of the window we want to open, and I wanted this function to be modular
		function showWindow(div){
			document.getElementById(div).style.display = "block";
			divClass = "." + div;
			
			// Check if there's a matching element in the taskbar and remove it if there is
			var classTest = findFirstChildByClass(document.getElementById("minimizedApps"), div);
			if(classTest != null){
				classTest.parentNode.remove();
			}
			return false;
		}
		
		// This is a function I found on Stackexhange that should pull any child element that matches a selector,
		// rather than the first descendant of an element. This wouldn't be necessary if I were using jQuery for
		// everything, but I'm having to fall back to javascript for some of it, so this is necessary.
		function findFirstChildByClass(element, className) {
        var foundElement = null, found;
        function recurse(element, className, found) {
            for (var i = 0; i < element.childNodes.length && !found; i++) {
                var el = element.childNodes[i];
                var classes = el.className != undefined? el.className.split(" ") : [];
                for (var j = 0, jl = classes.length; j < jl; j++) {
                    if (classes[j] == className) {
                        found = true;
                        foundElement = element.childNodes[i];
                        break;
                    }
                }
                if(found)
                    break;
                recurse(element.childNodes[i], className, found);
            }
        }
        recurse(element, className, false);
        return foundElement;
    }

    // Just a simple function that clears any element with a button press. Can accept classes or IDs
    function clearDiv(div){
    	if($("#" + div))
    		$("#" + div).empty();
    	else
    		$("." + div).empty();
    }
</script>
</body>
</html>
