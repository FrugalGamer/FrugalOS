// This is for webamp
const Webamp = window.Webamp;

function startWebamp() {
  new Webamp({
      initialTracks: [{
          metaData: {
              artist: "Rez-Kenet",
              title: "Unreel Superhero 3"
          },
          url: "files/music/essential-keygen-music/01 - rez+kenet - unreeeal superhero 3.mp3",
       }, {
          metaData: {
              artist: "Anachro",
              title: "A Sad Touch"
          },
          url: "files/music/essential-keygen-music/02 - anachro - a sad touch.mp3",
			 }, {
          metaData: {
              artist: "Falcon",
              title: "Spineless"
          },
          url: "files/music/essential-keygen-music/03 - falcon - spineless.mp3",
       }, {
          metaData: {
              artist: "Anachro",
              title: "BunnyBoobz"
          },
          url: "files/music/essential-keygen-music/04 - anachro - bunnyboobz.mp3",
       }, {
          metaData: {
              artist: "Arachno",
              title: "Granny's Mambo"
          },
          url: "files/music/essential-keygen-music/05 - arachno - granny's mambo.mp3",
       }, {
          metaData: {
              artist: "Laamaa",
              title: "Nelly in 8bit Land"
          },
          url: "files/music/essential-keygen-music/06 - laamaa - nelly in 8bit land.mp3",
       }, {
          metaData: {
              artist: "4mat",
              title: "Black Lipstick"
          },
          url: "files/music/essential-keygen-music/07 - 4mat - black lipstick.mp3",
       }, {
          metaData: {
              artist: "Algar",
              title: "Imorn e en annan dag"
          },
          url: "files/music/essential-keygen-music/08 - algar - imorn e en annan dag.mp3",
       }, {
          metaData: {
              artist: "Chavez",
              title: "Ninja Bolognese"
          },
          url: "files/music/essential-keygen-music/09 - chavez - ninja bolognese.mp3",
       }, {
          metaData: {
              artist: "Funky Fish",
              title: "R2-D2"
          },
          url: "files/music/essential-keygen-music/10 - Funky Fish - R2-D2.mp3",
       }, {
          metaData: {
              artist: "4mat",
              title: "Broken Heart"
          },
          url: "files/music/essential-keygen-music/11 - 4mat - broken heart.mp3",
       }, {
          metaData: {
              artist: "Arachno",
              title: "Tip of my Tongue"
          },
          url: "files/music/essential-keygen-music/12 - arachno - tip of my tongue.mp3",
       }, {
          metaData: {
              artist: "Gusse & Keyg & Loonie",
              title: "Synergetic"
          },
          url: "files/music/essential-keygen-music/13 - gusse & keyg & loonie - synergetic.mp3",
       }, {
          metaData: {
              artist: "JosSs",
              title: "Eklipse"
          },
          url: "files/music/essential-keygen-music/14 - JosSs - Eklipse.mp3",
       }, {
          metaData: {
              artist: "Moh",
              title: "Kontaktproblem"
          },
          url: "files/music/essential-keygen-music/15 - moh - kontaktproblem.mp3",
       }, {
          metaData: {
              artist: "Anders Dator Felix Dator",
              title: "2 x the SQUAREbeam"
          },
          url: "files/music/essential-keygen-music/16 - Anders Dator Felix Dator - 2 x the SQUAREbeam.mp3",
       }, {
          metaData: {
              artist: "Raina",
              title: "Slumberjack"
          },
          url: "files/music/essential-keygen-music/17 - raina - slumberjack.mp3",
       }, {
          metaData: {
              artist: "Seablue",
              title: "Jason the Spacecadet"
          },
          url: "files/music/essential-keygen-music/18 - seablue - jason the spacecadet.mp3",
       }, {
          metaData: {
              artist: "Nagz",
              title: "x  0  (.)  .  c"
          },
          url: "files/music/essential-keygen-music/19 - Nagz - x  0  (.)  .  c.mp3",
       }, {
          metaData: {
              artist: "4mat",
              title: "Eternity"
          },
          url: "files/music/essential-keygen-music/20 - 4mat - eternity.mp3",
       }, {
          metaData: {
              artist: "Cerror",
              title: "Close Encounter"
          },
          url: "files/music/essential-keygen-music/21 - cerror - close encounter.mp3",
       }, {
          metaData: {
              artist: "MrGamer",
              title: "Yes, I See"
          },
          url: "files/music/essential-keygen-music/22 - MrGamer - Yes, I see.mp3",
       }, {
          metaData: {
              artist: "AceMan",
              title: "Realize the Truth"
          },
          url: "files/music/essential-keygen-music/23 - AceMan - realize the truth.mp3",
       }, {
          metaData: {
              artist: "Bboll",
              title: "Mr. Spock's Cryo"
          },
          url: "files/music/essential-keygen-music/24 - bboll - mr spock's cryo.mp3",
       }, {
          metaData: {
              artist: "Joule",
              title: "Independent"
          },
          url: "files/music/essential-keygen-music/25 - joule - independent.mp3",
       }, {
          metaData: {
              artist: "Look & Zalza",
              title: "Little Computer Boy"
          },
          url: "files/music/essential-keygen-music/26 - look & zalza - little computer boy.mp3",
       }, {
          metaData: {
              artist: "Anders Dator Felix Dator",
              title: "No Name Level #1"
          },
          url: "files/music/essential-keygen-music/27 - Anders Dator Felix Dator - no name level #1.mp3",
       }, {
          metaData: {
              artist: "Saxxon Pike",
              title: "Broken"
          },
          url: "files/music/essential-keygen-music/28 - Saxxon Pike - Broken.mp3",
       }, {
          metaData: {
              artist: "Zalza",
              title: "Tuborg Heaven"
          },
          url: "files/music/essential-keygen-music/29 - Zalza - Tuborg Heaven.mp3",
       }, {
          metaData: {
              artist: "Tempest",
              title: "Acidjazzed Evening"
          },
          url: "files/music/essential-keygen-music/30 - tempest - acidjazzed evening.mp3",
          }
      ],
      enableDoubleSizeMode: true,
      initialSkin: {
		    url: "files/webamp/frugalSkin.wcz"
		  },
      __butterchurnOptions: {
          importButterchurn: () => Promise.resolve(window.butterchurn),
          getPresets: () => {
              const presets = window.butterchurnPresets.getPresets();
              return Object.keys(presets).map((name) => {
                  return {
                      name,
                      butterchurnPresetObject: presets[name]
                  };
              });
          },
          butterchurnOpen: true
      },
      __initialWindowLayout: {
          main: { position: { x: 0, y: 0 } },
          equalizer: { position: { x: 0, y: 116 } },
          playlist: { position: { x: 0, y: 232 }, size: [0, 4] },
          milkdrop: { position: { x: 275, y: 0 }, size: [7, 12] }
      }
  }).renderWhenReady(document.getElementById('winamp'));
};

  function addPlaylist(filePath) {
    //load file
    fullFilePath = "files/music/" + filePath;
    var pfileName = "";
    var result = [];

    $.get( fullFilePath, function( data ) {
      for(k = 0; k < data.length; k++){
      //If the line begins with #, then skip it
        if(data.charAt(k) == "#"){
          // Just increment the character index until we reach a new line
          while(data.charAt(k) != "\n")
            k++;
        }
        //lines that begin with "file/" are the path, so load it into the player
        else{
          // I'm incrementing the character index as above but storing everything in a variable first
          while(data.charAt(k) != "\n"){
            pfileName += data.charAt(k);
            k++;
          }
          // Once I've got the filename, I'll push it into an array for easy access later
          result.push(pfileName)
        }
      }
      // Now that the filenames have all been extracted, we'll get them in the right order and add then to the proper webamp functions

      Webamp.setTracksToPlay([ {url: "files/music/essential-keygen-music/29 - Zalza - Tuborg Heaven.mp3" } ]);
    });
  };

$( document ).ready(function() {
    $("#playlist-keygen").on("click", function() { 
      addPlaylist("EssentialKeygenMusic.m3u");
  });
})